-- CREATION TABLE ET CLES

CREATE TABLE Employes
(
    NOEMP INT(4) PRIMARY KEY NOT NULL,
    NOM VARCHAR(20),
    PRENOM VARCHAR(20),
    EMPLOI VARCHAR(20),
    SUP INT(4),
    EMBAUCHE DATE,
    SAL FLOAT(9,2),
    COMM FLOAT(9,2),
    NOSERV INT(2) NOT NULL
);

CREATE TABLE Services
(
    NOSERV INT(2) PRIMARY KEY NOT NULL,
    SERVICE VARCHAR(20),
    VILLE VARCHAR(20)
);

ALTER TABLE Employes
    ADD CONSTRAINT FOREIGN KEY (NOSERV) REFERENCES Services (NOSERV);

ALTER TABLE Employes
    ADD CONSTRAINT FOREIGN KEY (SUP) REFERENCES Employes (NOEMP);


-- INSERTION DONNEE 

INSERT INTO Employes (NOEMP, NOM, PRENOM, EMPLOI, SUP, EMBAUCHE, SAL, COMM, NOSERV)
    VALUES
    (1000, "LEROY", "PAUL", "PRESIDENT", null, "1987-10-25", 55005.5, null, 1),
    (1100, "DELPIERRE", "DOROTHEE", "SECRETAIRE", 1000, "1987-10-25", 12351.2, null, 1),
    (1200, "LEMAIRE", "GUY", "DIRECTEUR", 1000, "1987-03-11", 36303.6, null, 2),
    (1300, "LENOIR", "GERARD", "DIRECTEUR", 1000, "1987-04-02", 31353.1, 13071, 3),
    (1500, "DUPONT", "JEAN", "DIRECTEUR", 1000, "1987-10-23", 28434.8, null, 5),
    (1600, "LAVARE", "PAUL", "DIRECTEUR", 1000, "1991-12-13", 31238.1, null, 6),
    (1101, "DUMONT", "LOUIS", "VENDEUR", 1300, "1987-10-25", 9047.9, 0, 1),
    (1102, "MINET", "MARC", "VENDEUR", 1300, "1987-10-25", 8085.81, 17230, 1),
    (1104, "NYS", "ETIENNE", "TECHNICIEN", 1200, "1987-10-25", 12342.2, null, 1),
    (1105, "DENIMAL", "JEROME", "COMPTABLE", 1600, "1987-10-25", 15746.6, null, 1),
    (1201, "MARTIN", "JEAN", "TECHNICIEN", 1200, "1987-06-25", 11235.1, null, 2),
    (1202, "DUPONT", "JACQUES", "TECHNICIEN", 1200, "1988-10-30", 10313, null, 2),
    (1301, "GERARD", "ROBERT", "VENDEUR", 1300, "1999-04-16", 7694.77, 12430, 3),
    (1303, "MASURE", "EMILIE", "TECHNICIEN", 1200, "1988-06-17", 10451.1, null, 3),
    (1501, "DUPIRE", "PIERRE", "ANALYSTE", 1500, "1984-10-24", 23102.3, null, 5),
    (1502, "DURAND", "BERNARD", "PROGRAMMEUR", 1500, "1987-07-30", 13201.3, null, 5),
    (1503, "DELNATTE", "LUC", "PUPITREUR", 1500, "1999-01-15", 8801.01, null, 5),
    (1601, "CARON", "ALAIN", "COMPTABLE", 1600, "1985-09-16", 33003.3, null, 6),
    (1602, "DUBOIS", "JULES", "VENDEUR", 1300, "1990-12-20", 9520.95, 35535, 6),
    (1603, "MOREL", "ROBERT", "COMPTABLE", 1600, "1985-07-18", 33003.3, null, 6),
    (1604, "HAVET", "ALAIN", "VENDEUR", 1300, "1991-01-01", 9388.94, 33415, 6),
    (1605, "RICHARD", "JULES", "COMPTABLE", 1600, "1985-10-22", 33503.4, null, 5),
    (1615, "DUPREZ", "JEAN", "BALAYEUR", 1000, "1998-10-22", 6000.6, null, 5);

INSERT INTO Services (NOSERV, SERVICE, VILLE)
    VALUES
    (1, "DIRECTION", "PARIS"),
    (2, "LOGISTIQUE", "SECLIN"),
    (3, "VENTES", "ROUBAIX"),
    (4, "FORMATION", "VILLENEUVE D'ASCQ"),
    (5, "INFORMATIQUE", "LILLE"),
    (6, "COMPTABILITE", "LILLE"),
    (7, "TECHNIQUE", "ROUBAIX");

-- EXO

-- 1
SELECT * FROM Services;
-- 2
SELECT NOSERV, SERVICE, VILLE FROM Services; 
-- 3
SELECT NOSERV, SERVICE FROM Services;
-- 4
SELECT * FROM Employes;
-- 5
SELECT EMPLOI FROM Employes;
-- 6
SELECT DISTINCT EMPLOI FROM Employes ORDER BY EMPLOI asc;
-- 7
SELECT * FROM Employes WHERE NOSERV = 3;
-- 8
SELECT NOM, PRENOM, NOEMP, NOSERV FROM Employes WHERE EMPLOI = "TECHNICIEN";
-- 9
SELECT NOM, NOSERV FROM Employes WHERE NOSERV > 2;
-- 10
SELECT NOM, NOSERV FROM Employes WHERE NOSERV <= 2;
-- 11
SELECT * FROM Employes WHERE COMM > SAL;
-- 12
SELECT * FROM Employes WHERE COMM IS NULL;
-- 13
SELECT * FROM Employes WHERE COMM IS NOT NULL ORDER BY COMM;
-- 14
SELECT * FROM Employes WHERE SUP IS NOT NULL;
-- 15
SELECT * FROM Employes WHERE SUP IS NULL;
-- 16
SELECT NOM, EMPLOI, SAL, NOSERV FROM Employes WHERE NOSERV = 5 AND SAL > 20000;
-- 17
SELECT * FROM Employes WHERE NOSERV = 6 AND EMPLOI = "VENDEUR" AND SAL >= 9500;
-- 18
SELECT * FROM Employes WHERE EMPLOI = "PRESIDENT" OR EMPLOI = "DIRECTEUR";
-- 19
SELECT * FROM Employes WHERE EMPLOI = "DIRECTEUR" AND NOSERV != 3;
-- 20
SELECT * FROM Employes WHERE EMPLOI = "DIRECTEUR" OR (EMPLOI = "TECHNICIEN" AND NOSERV = 1);
-- 21
SELECT * FROM Employes WHERE (EMPLOI = "DIRECTEUR" OR EMPLOI = "TECHNICIEN") AND NOSERV = 1;
-- 22
SELECT * FROM Employes WHERE NOSERV = 1 AND (EMPLOI = "DIRECTEUR" OR EMPLOI = "TECHNICIEN");
-- 23
SELECT * FROM Employes WHERE NOSERV = 1 AND (EMPLOI != "DIRECTEUR" AND EMPLOI != "TECHNICIEN");
-- 24
SELECT * FROM Employes WHERE EMPLOI IN ("TECHNICIEN", "COMPTABLE", "VENDEUR");
-- 25
SELECT * FROM Employes WHERE EMPLOI NOT IN ("TECHNICIEN", "COMPTABLE", "VENDEUR");
-- 26
SELECT * FROM Employes WHERE EMPLOI IN ("DIRECTEUR") AND NOSERV IN (2, 4, 5);
-- 27
SELECT * FROM Employes WHERE EMPLOI NOT IN ("DIRECTEUR", "PRESIDENT") AND NOSERV NOT IN (1, 3, 5);
-- 28
SELECT * FROM Employes WHERE SAL BETWEEN 20000 AND 40000;
-- 29
SELECT * FROM Employes WHERE SAL BETWEEN 0 AND 20000 OR SAL > 40000;
-- 30
SELECT * FROM Employes WHERE EMPLOI NOT IN ("DIRECTEUR") AND EMBAUCHE LIKE "1988%";
-- 31
SELECT * FROM Employes WHERE EMPLOI = "DIRECTEUR" AND NOSERV BETWEEN 2 AND 5;
-- 32
SELECT * FROM Employes WHERE NOM LIKE "M%";
-- 33
SELECT * FROM Employes WHERE NOM LIKE "%T";
-- 34
SELECT * FROM Employes WHERE NOM LIKE "%E%E%";
-- 35
SELECT * FROM Employes WHERE NOM LIKE "%E%" AND NOM NOT LIKE "%E%E%";
-- 36
SELECT * FROM Employes WHERE NOM LIKE "%N%" AND NOM LIKE "%O%";
-- 37
SELECT * FROM Employes WHERE NOM LIKE "_____N";
-- 38
SELECT * FROM Employes WHERE NOM LIKE "__R%";
-- 39
SELECT * FROM Employes WHERE NOM NOT LIKE "_____";
-- 40
SELECT NOM, PRENOM, NOSERV, SAL FROM Employes WHERE NOSERV = 3 ORDER BY SAL;
-- 41
SELECT NOM, PRENOM, NOSERV, SAL FROM Employes WHERE NOSERV = 3 ORDER BY SAL desc;
-- 42
SELECT NOM, PRENOM, NOSERV, SAL FROM Employes WHERE NOSERV = 3 ORDER BY 4 desc;
-- 43
SELECT NOM, PRENOM, NOSERV, SAL, EMPLOI FROM Employes ORDER BY EMPLOI asc, SAL desc;
-- 44
SELECT NOM, PRENOM, NOSERV, SAL, EMPLOI FROM Employes ORDER BY 5 asc, 4 desc;
-- 45
SELECT NOM, PRENOM, NOSERV, COMM FROM Employes WHERE NOSERV = 3 ORDER BY COMM;
-- 46
SELECT NOM, PRENOM, NOSERV, COMM FROM Employes WHERE NOSERV = 3 AND IFNULL (COMM, 0) ORDER BY COMM desc;
SELECT NOM, PRENOM, NOSERV, IFNULL(COMM,0) FROM Employes WHERE NOSERV = 3 ORDER BY COMM desc;